<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Phone Deals - Home</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Arvo|Montserrat&display=swap" rel="stylesheet">
    <!-- FontAwesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../static/style.css" />
  </head>
  <body>
    <!-- HEADER -->
    <header class="header">
      <!-- Left Group: Title -->
      <div class="header__left">
        <div class="header__title">Phone Deals</div>
      </div>
      <!-- Center Group: Search, Navigation & Filter Button -->
      <div class="header__center">
        <form class="search" id="searchForm">
          <div class="search__wrapper">
            <input type="text" name="query" placeholder="Search for brand..." class="search__field" value="{{ query or '' }}"/>
            <input type="text" name="model" placeholder="Search for model..." class="search__field" value="{{ model or '' }}"/>
            <input type="number" name="min_price" placeholder="Min Price" class="search__field" value="{{ min_price or '' }}"/>
            <input type="number" name="max_price" placeholder="Max Price" class="search__field" value="{{ max_price or '' }}"/>
            <input type="number" name="price" placeholder="Specific Price" class="search__field" value="{{ price or '' }}"/>
            <button type="submit" class="search__icon">Search</button>
          </div>
        </form>
        <nav role="navigation" class="primary-navigation">
          <ul>
            <!-- Brands dropdown rendered via Jinja -->
            <li class="brands">
              <a href="#" id="brandSelector">
                Brands 
                <span class="dropdown-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" 
                       viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" 
                       stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="6 9 12 15 18 9"></polyline>
                  </svg>
                </span>
              </a>
              <ul class="dropdown brands-dropdown" id="brandsDropdown">
                {% for brand in brands %}
                  <li>
                    <a href="#" data-brand="{{ brand|lower }}">{{ brand|capitalize }}</a>
                  </li>
                {% endfor %}
              </ul>
            </li>
            <!-- Models dropdown: initially disabled -->
            <li class="models disabled">
              <a href="#" id="modelSelector">
                Models 
                <span class="dropdown-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" 
                       viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" 
                       stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="6 9 12 15 18 9"></polyline>
                  </svg>
                </span>
              </a>
              <ul class="dropdown models-dropdown" id="modelsDropdown">
                <!-- Will be populated via JS using rendered data -->
              </ul>
            </li>
          </ul>
        </nav>
        <button class="btn btn-filter">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
               viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2"
               stroke-linecap="round" stroke-linejoin="round">
            <polygon points="4 5 20 5 14 12 14 19 10 19 10 12 4 5"></polygon>
          </svg>
        </button>
      </div>
      <!-- Right Group: Favourites & Sign In -->
      <div class="header__right">
        <button class="btn btn-favourites">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
               viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2"
               stroke-linecap="round" stroke-linejoin="round">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 
                     5.5 0 1 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 
                     1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
          </svg>
        </button>
        <button class="btn btn-signin">
          <p>Sign In</p>
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
               viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="4"
               stroke-linecap="round" stroke-linejoin="round">
            <path d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
          </svg>
        </button>
      </div>
    </header>

    <!-- SLIDER SECTION -->
    <section class="slider-section">
      <div class="slider-container">
        <div class="slider-content">
          <div class="slider-single active">
            <img class="slider-single-image" src="https://picsum.photos/id/973/800/600" alt="Slide 1" />
          </div>
          <div class="slider-single">
            <img class="slider-single-image" src="https://picsum.photos/id/974/800/600" alt="Slide 2" />
          </div>
          <div class="slider-single">
            <img class="slider-single-image" src="https://picsum.photos/id/975/800/600" alt="Slide 3" />
          </div>
        </div>
        <div class="slider-arrows">
          <div class="slider-left">&larr;</div>
          <div class="slider-right">&rarr;</div>
        </div>
      </div>
    </section>

    <!-- MARQUEE SECTION -->
    <section class="marquee-section">
      <div class="marquee">
        <ul class="marquee-content">
          <li><i class="fab fa-github"></i></li>
          <li><i class="fab fa-codepen"></i></li>
          <li><i class="fab fa-free-code-camp"></i></li>
          <li><i class="fab fa-dev"></i></li>
          <li><i class="fab fa-react"></i></li>
          <li><i class="fab fa-vuejs"></i></li>
          <li><i class="fab fa-angular"></i></li>
          <li><i class="fab fa-node"></i></li>
          <li><i class="fab fa-wordpress"></i></li>
          <li><i class="fab fa-aws"></i></li>
          <li><i class="fab fa-docker"></i></li>
          <li><i class="fab fa-android"></i></li>
        </ul>
      </div>
    </section>

    <!-- BEST DEALS SECTION (Configured by admin) -->
    <section class="best-deals">
      <h2>Best Deals</h2>
      <div class="deals-container">
        {% if best_deals %}
          {% for brand, models in best_deals.items() %}
            {% for model, products in models.items() %}
              <div class="deal-card">
                <h3>{{ model|title }}</h3>
                {% for product in products %}
                  <div class="product-card">
                    <img src="{{ product.product_image }}" alt="{{ product.product_title }}" />
                    <h4>{{ product.product_title }}</h4>
                    <p>Price: ${{ product.latest_price }}</p>
                  </div>
                {% endfor %}
              </div>
            {% endfor %}
          {% endfor %}
        {% else %}
          <p>No best deals configured.</p>
        {% endif %}
      </div>
    </section>

    <!-- REGULAR PRODUCTS SECTION -->
    <section class="products-section">
      <h2>Products</h2>
      <div class="products-container">
        {% if phones %}
          {% for brand, models in phones.items() %}
            {% for model, products in models.items() %}
              <div class="model-section">
                <h3>{{ model|title }}</h3>
                {% for product in products %}
                  <div class="product-card">
                    <img src="{{ product.product_image }}" alt="{{ product.product_title }}" />
                    <h4>{{ product.product_title }}</h4>
                    <p>Price: ${{ product.latest_price }}</p>
                  </div>
                {% endfor %}
              </div>
            {% endfor %}
          {% endfor %}
        {% else %}
          <p>No products found.</p>
        {% endif %}
      </div>
    </section>

    <!-- Embed rendered data for use by JavaScript -->
    <script>
      // Global object to hold the models for each brand (provided via Jinja)
      const modelsByBrand = {{ models_by_brand | tojson }};
    </script>

    <!-- jQuery (if needed) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Custom JavaScript -->
    <script src="../static/script.js"></script>
  </body>
</html>
